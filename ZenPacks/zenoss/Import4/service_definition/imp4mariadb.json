{
    "servicePath": "/",
    "serviceDefinition" : {
        "Name": "Imp4MariaDB",
        "Description": "MariaDB (mysql) environment for import4",
        "Launch": "manual",
        "Command": "bash -c \"while echo 'Starting ..'; do if [[ -f /import4/pkg/bin/imp4mariadb.sh ]]; then /import4/pkg/bin/imp4mariadb.sh; else echo 'Startup script not ready ...'; sleep 7; fi; done;\"",
        "ImageID": "",
        "Tags": [
            "daemon"
            ],
        "Instances": {
            "Min": 1,
            "Max": 0,
            "Default": 0
        },
        "ChangeOptions": null,
        "Launch": "manual",
        "HostPolicy": "",
        "Hostname": "",
        "Privileged": false,
        "Context": null,
        "Endpoints": [
         {
           "Name": "zep_mariadb",
           "Purpose": "import",
           "Protocol": "tcp",
           "PortNumber": 3306,
           "PortTemplate": "",
           "VirtualAddress": "",
           "Application": "zep_mariadb",
           "ApplicationTemplate": "",
           "AddressConfig": {
             "Port": 0,
             "Protocol": ""
           },
           "VHosts": null
         },
         {
           "Name": "zodb_mariadb",
           "Purpose": "import",
           "Protocol": "tcp",
           "PortNumber": 3307,
           "PortTemplate": "",
           "VirtualAddress": "",
           "Application": "zodb_mariadb",
           "ApplicationTemplate": "",
           "AddressConfig": {
             "Port": 0,
             "Protocol": ""
           },
           "VHosts": null
         },
         {
           "Name": "zep",
           "Purpose": "import",
           "Protocol": "tcp",
           "PortNumber": 8084,
           "PortTemplate": "",
           "VirtualAddress": "",
           "Application": "zep",
           "ApplicationTemplate": "",
           "AddressConfig": {
             "Port": 0,
             "Protocol": ""
           },
           "VHosts": null
         },
         {
           "Name": "zproxy",
           "Application": "zproxy",
           "PortNumber": 8080,
           "Protocol": "tcp",
           "Purpose": "import"
         },
         {
           "Name": "controlplane_consumer",
           "Purpose": "import",
           "Protocol": "tcp",
           "PortNumber": 8444,
           "PortTemplate": "",
           "VirtualAddress": "",
           "Application": "controlplane_consumer",
           "ApplicationTemplate": "",
           "AddressConfig": {
             "Port": 0,
             "Protocol": ""
           },
           "VHosts": null
         }
       ],
       "Tasks": null,
       "LogFilters": null,
       "Volumes": [
         {
           "Owner": "mysql:mysql",
           "Permission": "0755",
           "ResourcePath": "mariadb-model",
           "ContainerPath": "/var/lib/mysql.model",
           "Type": ""
         },
         {
           "Owner": "mysql:mysql",
           "Permission": "0755",
           "ResourcePath": "mariadb-events",
           "ContainerPath": "/var/lib/mysql",
           "Type": ""
         },
         {
           "Owner": "zenoss:zenoss",
           "Permission": "0755",
           "ResourcePath": "zenoss-custom-patches-pc",
           "ContainerPath": "/opt/zenoss/.pc",
           "Type": ""
         },
         {
           "Owner": "zenoss:zenoss",
           "Permission": "0755",
           "ResourcePath": "zenoss-custom-patches",
           "ContainerPath": "/opt/zenoss/patches",
           "Type": ""
         },
         {
           "Owner": "zenoss:zenoss",
           "Permission": "0775",
           "ResourcePath": "zenoss-var-ext",
           "ContainerPath": "/opt/zenoss/var/ext",
           "Type": ""
         },
         {
           "Owner": "zenoss:zenoss",
           "Permission": "0775",
           "ResourcePath": "zenoss-export",
           "ContainerPath": "/opt/zenoss/export",
           "Type": ""
         },
         {
           "Owner": "zenoss:zenoss",
           "Permission": "0755",
           "ResourcePath": ".ssh",
           "ContainerPath": "/home/zenoss/.ssh",
           "Type": ""
         },
         {
           "Owner": "zenoss:zenoss",
           "Permission": "0775",
           "ResourcePath": "var-zenpacks",
           "ContainerPath": "/var/zenoss"
         },
         {
           "Owner": "zenoss:zenoss",
           "Permission": "0775",
           "ResourcePath": "import4",
           "ContainerPath": "/import4"
         }
       ],
       "LogConfigs": [ ],
       "Snapshot": {
         "Pause": "",
         "Resume": ""
       },
       "RAMCommitment": "256M",
       "CPUCommitment": 1,
       "Runs": null,
       "Actions": null,
       "HealthChecks": {
         "running": {
           "Script": "mysql --socket=/var/lib/mysql/mysql.sock -uroot -hlocalhost -P3306 -e 'select 1' && mysql --socket=/var/lib/mysql.model/mysql.sock -uroot -hlocalhost -P3307 -e 'select 1' > /dev/null",
           "Interval": 5.0
         }
       },
       "Prereqs": [
         {
           "Name": "MariaDB zodb and zep Availability",
           "Script": "su - zenoss -c '/opt/zenoss/bin/python /opt/zenoss/Products/ZenUtils/ZenDB.py --dbport 3306 --usedb zep --execsql=\";\"' && su - zenoss -c '/opt/zenoss/bin/python /opt/zenoss/Products/ZenUtils/ZenDB.py --dbport 3307 --usedb zodb --execsql=\";\"' "
         }
       ],
       "MonitoringProfile": {
         "MetricConfigs": null,
         "GraphConfigs": null,
         "ThresholdConfigs": null
       },
       "MemoryLimit": 0,
       "CPUShares": 0,
       "PIDFile": ""
    }
}
